-
  util.expected = [
    '<t>',
      '<singular>',
        '<li>la bague / sa largeur / son poids</li>',
        '<li>la largeur de la bague / son poids</li>',
        '<li>la largeur de la bague / sa largeur</li>',
      '</singular>',
      '<plural>',
        '<li>la largeur des boucles d\'oreille / leur largeur</li>',
      '</plural>',

      '<withrefexpr>',
        '<li>les boucles d\'oreille / leur largeur / le bijou / sa largeur</li>',
        '<li>la largeur des boucles d\'oreille / leur largeur / le bijou / sa largeur</li>',
      '</withrefexpr>',

    '</t>'
  ].join('');


-
  var BAGUE = {};
  BAGUE.ref = 'bague_ref';
mixin bague_ref(obj, params)
  | #[+value('bague', {represents:BAGUE, det:'DEFINITE'})]

-
  var BOUCLES = {};
  BOUCLES.ref = 'boucles_ref';
mixin boucles_ref(obj, params)
  | les boucles d'oreille
  - setRefGenderNumber(obj, 'F', 'P');

-
  var BIJOU = {};
  BIJOU.ref = 'bijou_ref';
  BIJOU.refexpr = 'bijou_refexpr';
mixin bijou_ref(obj, params)
  | les boucles d'oreille
  - setRefNumber(BIJOU, 'P');
mixin bijou_refexpr(obj, params)
  | le bijou
  - setRefNumber(BIJOU, 'S');

t
  singular
    li
      itemz {separator: '/'}
        item
          | #[+value(BAGUE)]
        item
          //-| #[+thirdPossession(BAGUE, 'largeur')]
          | #[+value('largeur', {owner:BAGUE})]
        item
          | #[+thirdPossession(BAGUE, 'poids')]
    - resetRep(BAGUE)
    
    li
      itemz {separator: '/'}
        item
          | #[+thirdPossession(BAGUE, 'largeur')]
        item
          | #[+thirdPossession(BAGUE, 'poids')]
    - resetRep(BAGUE)

    li
      eachz val in [0,1] with {separator:'/'}
        | #[+thirdPossession(BAGUE, 'largeur')]

  plural
    li
      eachz val in [0,1] with {separator:'/'}
        | #[+thirdPossession(BOUCLES, 'largeur')]

  withrefexpr
    li
      itemz {separator: '/'}
        item
          | #[+value(BIJOU)]
        item
          | #[+thirdPossession(BIJOU, 'largeur')]
        item
          | #[+value(BIJOU)]
        item
          | #[+thirdPossession(BIJOU, 'largeur')]
    
    - resetRep(BIJOU)
    li
      itemz {separator: '/'}
        item
          //-| #[+thirdPossession(BIJOU, 'largeur')]
          | #[+value('largeur', {owner:BIJOU})]
        item
          | #[+thirdPossession(BIJOU, 'largeur')]
        item 
          | #[+value(BIJOU)]
        item
          | #[+thirdPossession(BIJOU, 'largeur')]

